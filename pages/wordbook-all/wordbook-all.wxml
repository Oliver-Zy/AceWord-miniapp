<wxs module="tools" src="./wordbook-all.wxs"></wxs>

<!-- S container -->
<view class="container">

  <!-- S scroll-view -->
  <scroll-view 
    scroll-y="true" 
    refresher-enabled="true" 
    refresher-triggered="{{isRefresherTriggered}}" 
    style="height:{{scrollViewHeight}}px;position:fixed;top:{{naviBarHeight}}px;" 
    bind:refresherrefresh="onScrollViewRefresh">
    
    <!-- S wordbook categories -->
    <view style="height: 16px;"></view>
    
    <block wx:for="{{wordBookCategories}}" wx:key="categoryCode">
      <view class="category-card">
        <van-collapse 
          value="{{ activeNames }}" 
          bind:change="onCollapseChange"
          border="{{ false }}">
          
          <van-collapse-item 
            title="{{item.categoryName}}" 
            name="{{item.categoryCode}}"
            custom-class="collapse-item">
            
            <view slot="value" class="category-count">{{item.wordBooks.length}}本词书</view>
            
            <!-- S wordbook list -->
            <van-cell-group custom-class="wordbook-group">
              <block wx:for="{{item.wordBooks}}" wx:for-item="book" wx:key="wordBookCode">
                
                <van-cell 
                  title="{{book.wordBookName}}"
                  value="{{tools.formatProgress(book.userProgressNum, book.totalWordNum)}}"
                  label="{{book.totalWordNum}}个单词 · {{book.userNum}}人在学"
                  is-link
                  custom-class="wordbook-cell"
                  bind:click="onSelectWordBook"
                  data-book="{{book}}">
                  
                  <!-- S right content -->
                  <view slot="right-icon" class="book-tags">
                    <van-tag 
                      wx:if="{{book.isHot}}" 
                      type="warning" 
                      size="mini" 
                      plain>热门</van-tag>
                    <van-tag 
                      wx:if="{{book.isNew}}" 
                      type="success" 
                      size="mini" 
                      plain>新书</van-tag>
                  </view>
                  <!-- E right content -->
                  
                </van-cell>
                
              </block>
            </van-cell-group>
            <!-- E wordbook list -->
            
          </van-collapse-item>
          
        </van-collapse>
      </view>
      
      <view style="height: 12px;"></view>
    </block>
    <!-- E wordbook categories -->
    
    <!-- S empty state -->
    <view wx:if="{{isLoaded && wordBookCategories.length === 0}}" class="empty-state">
      <van-empty description="暂无词书数据" />
    </view>
    <!-- E empty state -->
    
    <view style="height: 30px;"></view>
    
  </scroll-view>
  <!-- E scroll-view -->

</view>
<!-- E container -->



<!-- S ace components -->
<ace-navi-bar 
  type="back" 
  title="{{selectedCategoryName || '词书广场'}}" 
  showDivider="{{showNaviBarDivider}}" 
  style="width:100%;position:fixed;top:0;" />
<!-- E ace components -->

<!-- S vant components -->
<van-toast id="van-toast" />
<van-dialog id="van-dialog" />
<!-- E vant components -->
